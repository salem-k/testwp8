appContext.controller("MenuController",["$timeout","$ionicViewSwitcher","$cordovaStatusbar","$ionicSideMenuDelegate","$scope","$state","$ionicHistory","LoginService","LoadingService","MenuService","$rootScope","$cordovaSQLite","$ionicPlatform","ConnectionService","BuzcardService","ContactsService","LoadingService","$compile",function($timeout,$ionicViewSwitcher,$cordovaStatusbar,$ionicSideMenuDelegate,$scope,$state,$ionicHistory,LoginService,LoadingService,MenuService,$rootScope,$cordovaSQLite,$ionicPlatform,ConnectionService,BuzcardService,ContactsService,LoadingService,$compile){$rootScope.isCusto=false;$rootScope.imgCusto="img/buzcard-online.png";var db=null;$ionicPlatform.ready(function(){if(window.cordova)$cordovaStatusbar.overlaysWebView(false);if(window.cordova){db=$cordovaSQLite.openDB("buzcard.db")}else{db=window.openDatabase("buzcard.db","1","my",1024*1024*10)}MenuService.setLocalStorage("currentMode","ONLINE");if(MenuService.getLocalStorage("ArrPhoto"))$rootScope.ArrPhoto=MenuService.getLocalStorage("ArrPhoto");$scope.currentMode="ONLINE";$scope.switchToMode="Mode OFF-line"});$scope.goTo=function(stateT){var Pages={"app.loading":1,"app.login":2,"app.synchro":3,"app.buzcard":4,"app.buzcardEdit":4,"app.buzcardSend":4,"app.contactList":5,"app.contactEdit":5,"app.contactShow":5,"app.qrcode":6,"app.commandes":7};to=Pages[stateT];from=Pages[$ionicHistory.currentStateName()];if(to>from)$ionicViewSwitcher.nextDirection("forward");else $ionicViewSwitcher.nextDirection("back");$state.go(stateT)};$scope.creditdeparrainage=function(){$state.go("app.creditParrainage")};$scope.deconnexion=function(){console.log("deconnexion");LoginService.deleteCredentials(db,function(result){if(result.rowsAffected!=0){$timeout(function(){$ionicHistory.clearCache();$ionicHistory.clearHistory()},1500);$ionicHistory.clearCache();window.localStorage.clear();$rootScope.isCusto=false;$rootScope.decon=true;$state.go("app.login",{},{reload:true})}else{LoadingService.error("erreur lors de d√©connection","MenuController")}})};$scope.toggleMode=function(currentMode){if(currentMode=="ONLINE"){MenuService.setLocalStorage("currentMode","OFFLINE");$scope.switchToMode="Mode ON-line";$scope.currentMode="OFFLINE";console.info($scope.currentMode)}else{MenuService.setLocalStorage("currentMode","ONLINE");$scope.switchToMode="Mode OFF-line";$scope.currentMode="ONLINE";console.log($scope.currentMode)}};$scope.dismiss=function(){LoadingService.dismiss()};$scope.synchronize=function(){LoadingService.questionSynchro("Voulez-vous lancer la synchronisation, cela risque de prendre plusieurs minutes ","UpdateController")}}]);